package kg.apc.jmeter.dcerpc;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.net.URISyntaxException;
import kg.apc.emulators.TestJMeterUtils;
import org.apache.jmeter.protocol.tcp.sampler.BinaryTCPClientImpl;
import org.apache.jorphan.util.JOrphanUtils;
import org.junit.After;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;
import static org.junit.Assert.*;

/**
 *
 * @author apc
 */
public class DCERPCMarshallingTest
{
   /**
    *
    */
   public DCERPCMarshallingTest()
   {
   }

   /**
    *
    * @throws Exception
    */
   @BeforeClass
   public static void setUpClass()
        throws Exception
   {
   }

   /**
    *
    * @throws Exception
    */
   @AfterClass
   public static void tearDownClass()
        throws Exception
   {
   }

   /**
    *
    */
   @Before
   public void setUp()
   {
   }

   /**
    *
    */
   @After
   public void tearDown()
   {
   }

   /**
    * Test of marshalData method, of class DCERPCSampler.
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts");
      String in_str = "00{t-adm-1}00";
      String expResult = "00742d61646d2d3100";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts2()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts2");
      String in_str = "00{t-adm-1}01{t-\r\n-1}02";
      String expResult = "00742d61646d2d3101742d0d0a2d3102";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_empty()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts2");
      String in_str = "00{t-adm-1}0{}1{t-\r\n-1}02";
      String expResult = "00742d61646d2d3101742d0d0a2d3102";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_russian()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts2");
      String in_str = "00{тест}02";
      String expResult = "00f2e5f1f202";
      String result = DCERPCMarshalling.marshalData(in_str);
      //assertEquals(expResult, result);
      System.err.println("Need to fix different behaviour on Linux and Windows");
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_empty2()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts2");
      String in_str = "00{t-adm-1}0{-:}1{t-\r\n-1}02";
      String expResult = "00742d61646d2d3102d3a1742d0d0a2d3102";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_length_prefixed()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_lp");
      String in_str = "00{L:test length prefixed}02";
      String expResult = "001400000074657374206c656e67746820707265666978656402";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_null_terminated()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_lp");
      String in_str = "00{Z:test zero terminated}02";
      String expResult = "0074657374207a65726f207465726d696e617465640002";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_length_prefixed_null_terminated()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_lpnt");
      String in_str = "00{N:test length prefixed}02";
      String expResult = "001500000074657374206c656e6774682070726566697865640002";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_bpp_invoke_xml()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_lp");
      String in_str = "00{X:test length prefixed}02";
      String expResult = "0015000000140000001400000074657374206c656e67746820707265666978656402";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_fixed_length()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_fl");
      String in_str = "01{F:32:test length prefixed}02";
      String expResult = "0174657374206c656e67746820707265666978656400000000000000000000000002";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_fixed_length2()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_fl2");
      String in_str = "01{F:4:test}02";
      String expResult = "017465737402";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_integer()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_int");
      String in_str = "01{I:23040978}02";
      String expResult = "01d2935f0102";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_marshal_integer2()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_int");
      String in_str = "01{I:0069252}02";
      String expResult = "01840e010002";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_MARSHAL_DOUBLE_LENGTH_PREFIXED_NULL_TERMINATED()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_lp");
      String in_str = "00{D:test length prefixed}02";
      String expResult = "0015000000000000001500000074657374206c656e6774682070726566697865640002";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_PREPARE_TRANS()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_p");

      String in_str = "00{P:<Parameters><Table>AMCASHINCOMEREQUESTS</Table><Branch>123026</Branch><Ident>0</Ident></Parameters>  }02";
      String expResult = "006500000065000000400d0300650000003c506172616d65746572733e3c5461626c653e414d43415348494e434f4d4552455155455354533c2f5461626c653e3c4272616e63683e3132333032363c2f4272616e63683e3c4964656e743e303c2f4964656e743e3c2f506172616d65746572733e202002";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testHexEncodeTextParts_DOUBLE()
        throws RPCMarshallingException
   {
      System.out.println("hexEncodeTextParts_p");

      String in_str = "{B:11458707}";
      String expResult = "0000006012db6541";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);
   }

   /**
    * Test of baToHexString method, of class BinaryUtils.
    */
   @Test
   public void testBaToHexString()
   {
      System.out.println("baToHexString");
      byte[] ba = String.valueOf("24352345").getBytes();
      String expResult = "{24352345}";
      String result = null;
      try
      {
         result = DCERPCMarshalling.unmarshalData(ba, "S");
      }
      catch (RPCMarshallingException ex)
      {
         fail(ex.getMessage());
      }
      assertEquals(expResult, result);
   }

   /**
    *
    */
   @Test
   public void testBaToHexString_tabs_newlines()
   {
      System.out.println("baToHexString3");
      byte[] ba = String.valueOf("1234567890").getBytes();
      ba[2] = 9;
      ba[4] = 10;
      ba[6] = 13;
      String expResult = "{12\t4\n6\r890}";
      String result = null;
      try
      {
         result = DCERPCMarshalling.unmarshalData(ba, "S");
      }
      catch (RPCMarshallingException ex)
      {
         fail(ex.getMessage());
      }
      assertEquals(expResult, result);
   }

   /**
    *
    */
   @Test
   public void testBaToHexString_russian() throws URISyntaxException, FileNotFoundException, IOException
   {
      System.out.println("baToHexString русский");
      byte[] ba = BinaryTCPClientImpl.hexStringToByteArray("00f2e5f1f2f202");
        
      InputStream is = this.getClass().getResourceAsStream("/kg/apc/jmeter/dcerpc/russian.txt");
        String cbuf = TestJMeterUtils.convertStreamToString(is);

      String expResult = "00{"+cbuf+"}02";
      String result = null;
      try
      {
         result = DCERPCMarshalling.unmarshalData(ba, "S:1");
      }
      catch (RPCMarshallingException ex)
      {
         fail(ex.getMessage());
      }
      //assertEquals(expResult, result);
      System.err.println("Need to fix different behaviour on Linux and Windows");
   }

   /**
    *
    * @throws RPCMarshallingException
    */
   @Test
   public void testBaToHexString_ASCII()
        throws RPCMarshallingException
   {
      //if (true) return;
      System.out.println("baToHexString2");
      byte[] ASCII = new byte[256];
      for (int n = 0; n < ASCII.length; n++)
      {
         ASCII[n] = (byte) n;
      }
      String result = DCERPCMarshalling.unmarshalData(ASCII, "");
      String baCheck = DCERPCMarshalling.marshalData(result);
      assertEquals(JOrphanUtils.baToHexString(ASCII), baCheck);
   }

   /**
    *
    */
   @Test
   public void testBaToHexString_shorts()
   {
      System.out.println("baToHexString4");
      byte[] ba = String.valueOf("1{23{456{7890{abcde{fg").getBytes();
      String expResult = "317b32337b3435367b373839307b{abcde}7b6667";
      String result = null;
      try
      {
         result = DCERPCMarshalling.unmarshalData(ba, "S");
      }
      catch (RPCMarshallingException ex)
      {
         fail(ex.getMessage());
      }
      assertEquals(expResult, result);
   }

   /**
    * Test of unmarshalData method, of class DCERPCMarshalling.
    * @throws Exception
    */
   @Test
   public void testUnmarshalData()
        throws Exception
   {
      System.out.println("unmarshalData");
      byte[] ba = new byte[0];
      String unmarshalOptions = "";
      String expResult = "";
      String result = DCERPCMarshalling.unmarshalData(ba, unmarshalOptions);
      assertEquals(expResult, result);
   }

   /**
    * Test of unmarshalData method, of class DCERPCMarshalling.
    * @throws Exception
    */
   @Test
   public void testUnmarshalData_Integer()
        throws Exception
   {
      System.out.println("unmarshalData int");
      byte[] ba = BinaryTCPClientImpl.hexStringToByteArray("01000000" + "01000000" + "010000");
      String unmarshalOptions = "I";
      String expResult = "{1,1,}010000";
      String result = DCERPCMarshalling.unmarshalData(ba, unmarshalOptions);
      assertEquals(expResult, result);
   }

   /**
    *
    * @throws Exception
    */
   @Test
   public void testUnmarshalData_Integer_Limited()
        throws Exception
   {
      System.out.println("unmarshalData int");
      byte[] ba = BinaryTCPClientImpl.hexStringToByteArray("01000000" + "01000000" + "01000000" + "01000000");
      String unmarshalOptions = "I:3";
      String expResult = "{1,1,1,}01000000";
      String result = DCERPCMarshalling.unmarshalData(ba, unmarshalOptions);
      assertEquals(expResult, result);
   }

   /**
    * Test of marshalData method, of class DCERPCMarshalling.
    * @throws Exception
    */
   @Test
   public void testMarshalData()
        throws Exception
   {
      System.out.println("marshalData");
      String in_str = "";
      String expResult = "";
      String result = DCERPCMarshalling.marshalData(in_str);
      assertEquals(expResult, result);

      //String data="63643032316337332d346535302d343063622d623734352d3766356634623232306536660000000008000000000000000800000043534355455849008c1b00008c1b00008c1b00008c1b00003c3f786d6c2076657273696f6e3d22312e30223f3e0d0a3c4f72646572733e0d0a093c4f726465723e0d0a09093c5472616e73616374696f6e204469616c6f673d22425050434153484945582220436f6e6669726d6174696f6e3d223338302c3230222048656c703d22485f425050434153485f5243505422205469746c653d224578656375746520496e636173736f205265717565737422204368617267653d22223e3c436f64653e435343554558493c2f436f64653e3c46756c6c4e756d626572204e756d6265723d22342220556e69743d22554e49545f54524e554d4245525f45442220436f64653d223138302220466f726d61743d224e22204c656e6774683d2238222046756e6374696f6e3d2250726f635472616e73616374696f6e4e6d6222205061747465726e3d222531302e3266223e31313435383730372e30313c2f46756c6c4e756d6265723e3c496e7465726368616e6765204e756d6265723d2234342220556e69743d22554e49545f494e5445524348414e47452220466f726d61743d224322204c656e6774683d22323530222f3e3c2f5472616e73616374696f6e3e0d0a09093c536572766963653e3c44617465204e756d6265723d22312220556e69743d22554e49545f4f5244444154455f45442220436f64653d223131392220466f726d61743d224422204c656e6774683d2230222046756e6374696f6e3d2250726f634f7264657244617465223e323031302d30322d31313c2f446174653e3c496e636f6d696e67526566204e756d6265723d22332220556e69743d22554e49545f4f524445525f4e4d425f45442220436f64653d223238392220466f726d61743d224322204c656e6774683d223230222046756e6374696f6e3d2250726f634f726465725265666572656e6365223e313c2f496e636f6d696e675265663e3c466c6167733e3c4465626974204e756d6265723d2232312220556e69743d22554e49545f44454249545f52422220436f64653d223131332220466f726d61743d224922204c656e6774683d2234222046756e6374696f6e3d2250726f634465626974436865636b626f78223e373636373833303c2f44656269743e3c416464546f42656e65666963696172696573204e756d6265723d2233362220556e69743d22554e49545f414444544f42454e5245465f4348422220436f64653d223139302220466f726d61743d224322204c656e6774683d2231222046756e6374696f6e3d2250726f63416464546f42656e223e4e3c2f416464546f42656e656669636961726965733e3c2f466c6167733e3c526174653e3c52617465204e756d6265723d2232332220556e69743d22554e49545f524154455f45442220436f64653d223137352220466f726d61743d224e22204c656e6774683d2238222046756e6374696f6e3d2250726f6352617465734c69737422205061747465726e3d222531392e3966223e312e3030303030303030303c2f526174653e3c537072656164204e756d6265723d2232342220556e69743d22554e49545f5350524541445f45442220436f64653d223237372220466f726d61743d224e22204c656e6774683d2238222046756e6374696f6e3d2250726f6352617465734c69737422205061747465726e3d222531322e3966223e302e3030303030303030303c2f5370726561643e3c2f526174653e3c4368617267653e3c416d6f756e74204e756d6265723d2232372220556e69743d22554e49545f4348415247455f45442220436f64653d223132312220466f726d61743d224e22204c656e6774683d2238222046756e6374696f6e3d2250726f6343686172676522205061747465726e3d222531392e3266223e302e30303c2f416d6f756e743e3c43757272656e6379204e756d6265723d2232382220556e69743d22554e49545f4348415247455f435552525f45442220436f64653d223230322220466f726d61743d224322204c656e6774683d2233222046756e6374696f6e3d2250726f6343686172676543757272656e6379223e4b47533c2f43757272656e63793e3c2f4368617267653e3c44657461696c73204e756d6265723d2233312220556e69743d22554e49545f44455441494c535f45442220436f64653d223132382220466f726d61743d224322204c656e6774683d22363030222046756e6374696f6e3d2250726f637344657461696c73223e6c6f61642074657374203120666f7220726e64203433373c2f44657461696c733e3c496e636173736f426167204e756d6265723d2233322220556e69743d22554e49545f494e434153534f5f4241475f45442220436f64653d223435302220466f726d61743d224322204c656e6774683d223335222046756e6374696f6e3d2250726f6373496e636173736f426167223e3c2f496e636173736f4261673e3c4e6f7465204e756d6265723d2233352220556e69743d22554e49545f4e4f54455f45442220436f64653d223337302220466f726d61743d224322204c656e6774683d22363030222046756e6374696f6e3d2250726f634e6f7465223e3c2f4e6f74653e3c5061796d656e74436f6465204e756d6265723d2233372220556e69743d22554e49545f52454645525f45442220436f64653d223238312220466f726d61743d224322204c656e6774683d22323530222046756e6374696f6e3d2250726f635265666572223e5245464552454e43455c395c31303030303030305c31313030303030305c31313130303030305c31313131303030305c31313131313030305c31313131313130303c2f5061796d656e74436f64653e3c416e616c797365436f646548696e74204e756d6265723d2234312220556e69743d22554e49545f414e434f44455f48494e545f45442220436f64653d223334362220466f726d61743d224322204c656e6774683d22323530222046756e6374696f6e3d2250726f63416e436f646548696e74223e34353c2f416e616c797365436f646548696e743e3c2f536572766963653e3c4f74686572436f6e74726f6c733e3c436f6e74726f6c204e756d6265723d22322220556e69743d22554e49545f4f5244444154455f4d53422220436f64653d2231323022204c656e6774683d2230222046756e6374696f6e3d2250726f634f72646572446174655370696e222f3e3c436f6e74726f6c204e756d6265723d22362220556e69743d22554e49545f56414c444154455f4d53422220436f64653d2231303122204c656e6774683d2230222046756e6374696f6e3d2250726f6356616c7565446174655370696e222f3e3c436f6e74726f6c204e756d6265723d22382220556e69743d22554e49545f434f52525f56414c444154455f4d53422220436f64653d2231313122204c656e6774683d2230222046756e6374696f6e3d2250726f634e6f7374726f56616c7565446174655370696e222f3e3c436f6e74726f6c204e756d6265723d2232302220556e69743d22554e49545f52415445535f50422220436f64653d2231323622204c656e6774683d2230222046756e6374696f6e3d2250726f635261746573427574746f6e222f3e3c436f6e74726f6c204e756d6265723d2232322220556e69743d22554e49545f4352454449545f52422220436f64653d223131342220466f726d61743d224922204c656e6774683d2234222046756e6374696f6e3d2250726f634465626974436865636b626f78223e373636373833303c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2232392220556e69743d22554e49545f53454c4543545f4f5249475f50422220436f64653d2234303322204c656e6774683d2230222046756e6374696f6e3d2250726f637342656e53656c656374222f3e3c436f6e74726f6c204e756d6265723d2233332220556e69743d22554e49545f524154455349474e5f43482220436f64653d223336372220466f726d61743d224922204c656e6774683d2234222046756e6374696f6e3d2250726f63526174655369676e436865636b626f78223e313c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234322220556e69743d22554e49545f4f4b2220436f64653d2234363022204c656e6774683d2230222046756e6374696f6e3d2250726f634f4b427574746f6e222f3e3c436f6e74726f6c204e756d6265723d2234332220556e69743d22554e49545f43414e43454c2220436f64653d2234363122204c656e6774683d2230222046756e6374696f6e3d2250726f6343616e63656c427574746f6e222f3e3c436f6e74726f6c204e756d6265723d2231352220556e69743d22554e49545f42454e5f434c49454e545f45442e5343524950542220466f726d61743d224322204c656e6774683d22323530223e53756220496e69743a20554e49545f42454e5f434c49454e545f45442e417661696c6162696c6974793d303a20456e64205375623c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2232352220556e69743d22554e49545f4352454449545f414d4f554e545f45442e5343524950542220466f726d61743d224322204c656e6774683d22323530223e53756220496e69743a20554e49545f4352454449545f414d4f554e545f45442e417661696c6162696c6974793d303a20456e64205375623c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2232362220556e69743d22554e49545f504149445f414d4f554e545f45442e5343524950542220466f726d61743d224322204c656e6774683d22323530223e53756220496e69743a20554e49545f504149445f414d4f554e545f45442e417661696c6162696c6974793d303a20456e64205375623c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234342220556e69743d22554e49545f535452494e47312220436f64653d223530302220466f726d61743d224322204c656e6774683d22323530223e434c43554952513c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234342220556e69743d22554e49545f4f524445525f49442220466f726d61743d224322204c656e6774683d22323530223e32383830383931393c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234342220556e69743d22554e49545f42454e5f4143435f4e4d425f45442220436f64653d223334322220466f726d61743d224322204c656e6774683d2237222046756e6374696f6e3d2250726f6342656e65666963696172794163636f756e74223e303730303033303c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234342220556e69743d22554e49545f42454e5f4143434b494e445f45442220436f64653d223334302220466f726d61743d224322204c656e6774683d2232222046756e6374696f6e3d22536b6970223e43413c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234342220556e69743d22554e49545f42454e5f5355424143435f45442220436f64653d223334312220466f726d61743d224322204c656e6774683d2234222046756e6374696f6e3d22536b6970223e313c2f436f6e74726f6c3e3c436f6e74726f6c204e756d6265723d2234342220556e69743d22554e49545f435552525f45442220436f64653d223130322220466f726d61743d224322204c656e6774683d2233222046756e6374696f6e3d2250726f6343757272656e6379223e4b47533c2f436f6e74726f6c3e3c2f4f74686572436f6e74726f6c733e3c42656e65666963696172793e3c4163636f756e743e3c4372656469743e3c44617465204e756d6265723d22352220556e69743d22554e49545f56414c444154455f45442220436f64653d223130302220466f726d61743d224422204c656e6774683d2230222046756e6374696f6e3d2250726f6356616c756544617465223e323031302d30322d31303c2f446174653e3c53706c6974204e756d6265723d2231392220556e69743d22554e49545f4352454449545f53504c49545f5452414e535f50422220436f64653d223239362220466f726d61743d224222204c656e6774683d22313530302220436f6d706c65783d223122205472616e73666f726d65723d2254524f5f53504c49542e78736c222046756e6374696f6e3d2250726f6353706c69745472616e73222f3e3c416d6f756e74204e756d6265723d2232352220556e69743d22554e49545f4352454449545f414d4f554e545f45442220436f64653d223131372220466f726d61743d224e22204c656e6774683d2238222046756e6374696f6e3d2250726f63437265646974416d6f756e7422205061747465726e3d222531392e3266223e3430302e30303c2f416d6f756e743e3c2f4372656469743e3c4b6579204e756d6265723d2231332220556e69743d22554e49545f42454e5f46554c4c5f4143435f43422220436f64653d223333372220466f726d61743d224322204c656e6774683d223139222046756e6374696f6e3d2250726f6342656e46756c6c4163636f756e744342223e303730303033302f43412f4b47532f313c2f4b65793e3c4e756d626572204e756d6265723d2231342220556e69743d22554e49545f42454e5f4c4f43414c5f4143435f43422220436f64653d223333352220466f726d61743d224322204c656e6774683d223335222046756e6374696f6e3d2250726f6342656e4c6f63616c4163636f756e744342223e313233303037303030343630333537353c2f4e756d6265723e3c43757272656e6379204e756d6265723d2231382220556e69743d22554e49545f435552525f43422220436f64653d223132332220466f726d61743d224322204c656e6774683d2233222046756e6374696f6e3d2250726f6343757272656e63794c697374223e4b47533c2f43757272656e63793e3c2f4163636f756e743e3c437573746f6d65723e3c4e616d65204e756d6265723d2231352220556e69743d22554e49545f42454e5f434c49454e545f45442220436f64653d223333362220466f726d61743d224322204c656e6774683d223634222046756e6374696f6e3d2250726f6342656e6566696369617279436c69656e744e616d65223e4c6f616420746573742064756d6d793c2f4e616d653e3c2f437573746f6d65723e3c496e4661766f75724f663e3c437573746f6d65723e3c4e616d65204e756d6265723d2231362220556e69743d22554e49545f494e4641564f525f45442220436f64653d223239302220466f726d61743d224322204c656e6774683d223938222046756e6374696f6e3d2250726f63496e4661766f724f66223e3c2f4e616d653e3c2f437573746f6d65723e3c4163636f756e743e3c4e756d626572204e756d6265723d2231372220556e69743d22554e49545f494e4641564f525f4143435f45442220436f64653d223239312220466f726d61743d224322204c656e6774683d223335222046756e6374696f6e3d2250726f63496e4661766f724f66416363223e3c2f4e756d6265723e3c2f4163636f756e743e3c2f496e4661766f75724f663e3c2f42656e65666963696172793e3c4e6f7374726f3e3c4163636f756e743e3c44656269743e3c44617465204e756d6265723d22372220556e69743d22554e49545f434f52525f56414c444154455f45442220436f64653d223131302220466f726d61743d224422204c656e6774683d2230222046756e6374696f6e3d2250726f634e6f7374726f56616c756544617465223e323031302d30322d31303c2f446174653e3c2f44656269743e3c43757272656e6379204e756d6265723d2231322220556e69743d22554e49545f434f52525f4143435f435552525f45442220436f64653d223130392220466f726d61743d224322204c656e6774683d2233222046756e6374696f6e3d2250726f634e6f7374726f43757272656e6379223e4b47533c2f43757272656e63793e3c2f4163636f756e743e3c42616e6b3e3c436f6465204e756d6265723d22392220556e69743d22554e49545f42414e4b5f45442220436f64653d223137322220466f726d61743d224322204c656e6774683d223131222046756e6374696f6e3d2250726f6342616e6b4e616d65223e4153554a4b4732325858583c2f436f64653e3c436f72724163636f756e74204e756d6265723d2231312220556e69743d22554e49545f4e4f5354524f5f4143434f554e545f45442220436f64653d223137342220466f726d61743d224322204c656e6774683d2237222046756e6374696f6e3d2250726f634e6f7374726f4163636f756e744e756d626572223e4e3335373936393c2f436f72724163636f756e743e3c2f42616e6b3e3c2f4e6f7374726f3e3c4f726967696e61746f723e3c4272616e63683e3c4e616d65204e756d6265723d2231302220556e69743d22554e49545f4252414e43485f434f44455f45442220436f64653d223635302220466f726d61743d224322204c656e6774683d2237222046756e6374696f6e3d2250726f634272616e6368436f6465223e3132333032363c2f4e616d653e3c2f4272616e63683e3c4163636f756e743e3c44656269743e3c416d6f756e74204e756d6265723d2232362220556e69743d22554e49545f504149445f414d4f554e545f45442220436f64653d223131382220466f726d61743d224e22204c656e6774683d2238222046756e6374696f6e3d2250726f6350616964416d6f756e7422205061747465726e3d222531392e3266223e3430302e30303c2f416d6f756e743e3c53706c6974204e756d6265723d2233342220556e69743d22554e49545f4352454449545f414e434f44455f50422220436f64653d223130362220466f726d61743d224222204c656e6774683d22313530302220436f6d706c65783d223122205472616e73666f726d65723d2254524f5f53504c49542e78736c222046756e6374696f6e3d2250726f63416e616c697a65436f6465222f3e3c2f44656269743e3c2f4163636f756e743e3c437573746f6d65723e3c4e616d65204e756d6265723d2233302220556e69743d22554e49545f4f5249475f4e414d455f45442220436f64653d223430302220466f726d61743d224322204c656e6774683d223938222046756e6374696f6e3d2250726f637342656e4e616d65223e6c6f616420746573742073656e6465723c2f4e616d653e3c4f4b504f204e756d6265723d2233382220556e69743d22554e49545f4f52475f4f4b504f5f45442220436f64653d223336362220466f726d61743d224322204c656e6774683d2238222046756e6374696f6e3d2250726f637342656e5f4f4b504f223e3c2f4f4b504f3e3c53464f4e44204e756d6265723d2233392220556e69743d22554e49545f4f52475f53464f4e445f45442220436f64653d223336332220466f726d61743d224322204c656e6774683d223134222046756e6374696f6e3d2250726f637342656e5f53466f6e64223e3c2f53464f4e443e3c494e4e204e756d6265723d2234302220556e69743d22554e49545f4f52475f53534e5f45442220436f64653d223337322220466f726d61743d224322204c656e6774683d223230222046756e6374696f6e3d2250726f637342656e5f53534e223e3c2f494e4e3e3c2f437573746f6d65723e3c2f4f726967696e61746f723e3c2f4f726465723e0d0a3c2f4f72646572733e0d0a";
      //System.out.println(DCERPCMarshalling.unmarshalData(BinaryTCPClientImpl.hexStringToByteArray(data), "S"));
   }
}
